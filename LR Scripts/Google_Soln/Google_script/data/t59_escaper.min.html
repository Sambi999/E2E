define(['escaper'],function(escaper){'use strict';return{neverAllowedElements:['script','embed','iframe','video','source','object','audio'],generallyAllowedAttributes:['id','class','href','title','style'],forbiddenAttributesByElement:{a:['style']},escapeHtmlAllowedTags:[],escapeHtml:function(data,allowedTags){escaper.neverAllowedElements=this.neverAllowedElements;this.escapeHtmlAllowedTags=allowedTags;escaper.escapeHtmlAllowedTags=allowedTags;escaper._removeNotAllowedAttributes=this._removeNotAllowedAttributes;escaper._removeComments=this._removeComments;return escaper.escapeHtml(data,allowedTags);},_removeNotAllowedAttributes:function(node){var treeWalker=node.ownerDocument.createTreeWalker(node,NodeFilter.SHOW_ELEMENT,function(){return NodeFilter.FILTER_ACCEPT;},false),i,attribute,nodeName,attributesToRemove=[];while(treeWalker.nextNode()){for(i=0;i<treeWalker.currentNode.attributes.length;i++){attribute=treeWalker.currentNode.attributes[i];nodeName=treeWalker.currentNode.nodeName.toLowerCase();if(this.escapeHtmlAllowedTags.indexOf(nodeName)!==-1){continue;}
if(this.generallyAllowedAttributes.indexOf(attribute.name)===-1||this._checkHrefValue(attribute)||this.forbiddenAttributesByElement[nodeName]&&this.forbiddenAttributesByElement[nodeName].indexOf(attribute.name)!==-1){attributesToRemove.push(attribute);}}}
attributesToRemove.forEach(function(attributeToRemove){attributeToRemove.ownerElement.removeAttribute(attributeToRemove.name);});},_escapeJs:function(data){var regex=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi;return data.replace(regex,'');},escapeHtmlMixed:function(data){if(typeof(data)==='array'||typeof(data)==='object'){for(let dataKey in data){data[dataKey]=this.escapeHtml(data[dataKey]);}
return data;}
if(typeof(data)!=='string'){return data;}
return this.escapeHtml(data);},_removeComments:function(node){return true;}};});